# EBOM Viewer

## 概要

Excelファイル（ebom.xlsx）の3つのシート（Structure、Parts List、Parts）を連結して表示するStreamlitアプリケーションです。階層構造をドリルダウンしながら製品構成を探索し、最終的に部品の詳細情報を確認できます。

## 機能

- **Structure Parent**: 製品構成の親品番リストを表示（階層選択後は階層パスを表示）
- **Structure Child**: 選択された親品番の子品番リストを表示
- **階層ドリルダウン**: 子品番が親品番としてさらに子を持つ場合、階層を下って探索を継続
- **Parts List**: 最終子品番（これ以上子を持たない）の部品番号リストを表示
- **Parts**: 選択された部品番号の詳細情報（品目名称、メーカ名、メーカ型式、統一名称）を表示

## 使い方

### 1. 依存関係のインストール

```bash
pip install -r requirements.txt
```

### 2. アプリケーションの起動

```bash
streamlit run app.py
```

### 3. 操作方法

#### 初期画面
1. **Structure Parent**カラムで親品番を選択し、「選択」ボタンをクリック

#### 階層探索
2. **Structure Child**カラムで子品番を選択
3. 選択した子品番がさらに子を持つ場合、「階層を下る」ボタンが表示される
4. ボタンをクリックすると、その子品番が新しい親品番となり、Structure Childが更新される
5. この操作を、選択した子品番がもう親品番として存在しなくなるまで繰り返す

#### 部品情報の確認
6. 最終子品番（これ以上子を持たない）が選択されると、**Parts List**カラムに部品番号リストが表示される
7. **Parts List**カラムで部品番号を選択
8. **Parts**カラムで部品の詳細情報を確認

#### 階層の移動
- **Structure Parent**カラムの階層パス内のボタンをクリックすると、その階層に戻る
- 「最初に戻る」ボタンで初期画面に戻る

## データ構造

### 必要なExcelファイル

- `ebom.xlsx` (アプリケーションと同じディレクトリに配置)

### シート構成

1. **Structure**: 製品構成
   - Key: 親品番、子品番

2. **Parts List**: 部品表
   - Key: 親品番、部品番号

3. **Parts**: 部品仕様
   - Key: 子品番、部品番号
   - 表示項目: 品目名称、メーカ名、メーカ型式、統一名称

## 技術スタック

- Python 3.x
- Streamlit: Webアプリケーションフレームワーク
- pandas: データ処理
- openpyxl: Excel読み込み
